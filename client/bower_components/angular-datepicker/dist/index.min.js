"use strict";(function(n){function i(n,t){n=new Date(n||new Date);n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours());for(var i=[],r=n.getTime()+36e5;n.getTime()<r;)i.push(n),n=new Date(n.getTime()+t*6e4);return i}function r(n){var t,i,r;for(n=new Date(n||new Date),n.setDate(1),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n.getDay()===0?n.setDate(-5):n.setDate(n.getDate()-(n.getDay()-1)),n.getDate()===1&&n.setDate(-6),t=[];t.length<6;){for(i=[],r=0;r<7;r++)i.push(new Date(n)),n.setDate(n.getDate()+1);t.push(i)}return t}function u(n){var i=[],t;for(n=new Date(n||new Date),n.setFullYear(n.getFullYear()-n.getFullYear()%10),t=0;t<12;t++)i.push(new Date(n.getFullYear()+(t-1),0,1));return i}function f(n){var t,i;for(n=new Date(n||new Date),n=new Date(n.getFullYear(),n.getMonth(),n.getDate()),n.setDate(n.getDate()-(n.getDay()-1)),t=[],i=0;i<7;i++)t.push(new Date(n)),n.setDate(n.getDate()+1);return t}function e(n){var r,i,t;for(n=new Date(n||new Date),r=n.getFullYear(),i=[],t=0;t<12;t++)i.push(new Date(r,t,1));return i}function o(n){var t,i;for(n=new Date(n||new Date),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),t=[],i=0;i<24;i++)t.push(n),n=new Date(n.getTime()+36e5);return t}var t=n.module("datePicker",[]);t.constant("datePickerConfig",{template:"templates/datepicker.html",view:"month",views:["year","month","date","hours","minutes"],step:5,dismiss:!1});t.directive("datePicker",function(t,s){return{template:'<div ng-include="template"><\/div>',scope:{model:"=datePicker",after:"=?",before:"=?"},link:function(h,c,l){function v(){var t=h.view,n=h.date;switch(t){case"year":h.years=u(n);break;case"month":h.months=e(n);break;case"date":h.weekdays=h.weekdays||f();h.weeks=r(n);break;case"hours":h.hours=o(n);break;case"minutes":h.minutes=i(n,a)}}function p(){return h.view!=="date"?h.view:h.model?h.model.getMonth():null}h.date=new Date(h.model||new Date);h.views=t.views.concat();h.view=l.view||t.view;h.now=new Date;h.template=l.template||t.template;var y=l.dismiss?s(l.dismiss)(h):t.dismiss,a=parseInt(l.step||t.step,10);h.views=h.views.slice(h.views.indexOf(l.maxView||"year"),h.views.indexOf(l.minView||"minutes")+1);(h.views.length===1||h.views.indexOf(h.view)===-1)&&(h.view=h.views[0]);h.setView=function(n){h.views.indexOf(n)!==-1&&(h.view=n)};h.setDate=function(t){h.date=t;var i=h.views[h.views.indexOf(h.view)+1];if(!i||h.model){h.model=new Date(h.model||t);switch(h.view){case"minutes":h.model.setMinutes(t.getMinutes());case"hours":h.model.setHours(t.getHours());case"date":h.model.setDate(t.getDate());case"month":h.model.setMonth(t.getMonth());case"year":h.model.setFullYear(t.getFullYear())}h.$emit("setDate",h.model,h.view)}i?h.setView(i):y&&n.element(".dropdown-toggle").parent().removeClass("open")};h.$watch(p,v);h.next=function(n){var t=h.date;n=n||1;switch(h.view){case"year":case"month":t.setFullYear(t.getFullYear()+n);break;case"date":t.setMonth(t.getMonth()+n);break;case"hours":case"minutes":t.setHours(t.getHours()+n)}v()};h.prev=function(n){return h.next(-n||-1)};h.isAfter=function(n){return h.after?h.after.getTime()<=n.getTime():!1};h.isBefore=function(n){return h.before?h.before.getTime()>=n.getTime():!1};h.isSameMonth=function(n){return h.isSameYear(n)&&h.model.getMonth()===n.getMonth()};h.isSameYear=function(n){return h.model?h.model.getFullYear()===n.getFullYear():!1};h.isSameDay=function(n){return h.isSameMonth(n)&&h.model.getDate()===n.getDate()};h.isSameHour=function(n){return h.isSameDay(n)&&h.model.getHours()===n.getHours()};h.isSameMinutes=function(n){return h.isSameHour(n)&&h.model.getMinutes()===n.getMinutes()};h.isNow=function(n){var t=!0,i=h.now;switch(h.view){case"minutes":t&=~~(n.getMinutes()/a)==~~(i.getMinutes()/a);case"hours":t&=n.getHours()===i.getHours();case"date":t&=n.getDate()===i.getDate();case"month":t&=n.getMonth()===i.getMonth();case"year":t&=n.getFullYear()===i.getFullYear()}return t}}}});t=n.module("datePicker");t.directive("dateRange",function(){return{templateUrl:"templates/daterange.html",scope:{start:"=",end:"="},link:function(n){n.$watch("start.getTime()",function(t){t&&n.end&&t>n.end.getTime()&&(n.end=new Date(t))});n.$watch("end.getTime()",function(t){t&&n.start&&t<n.start.getTime()&&(n.start=new Date(t))})}}});"use strict";var s="ng-pristine",h="ng-dirty",t=n.module("datePicker");t.constant("dateTimeConfig",{template:function(n){return'<div date-picker="'+n.ngModel+'" '+(n.view?'view="'+n.view+'" ':"")+(n.maxView?'max-view="'+n.maxView+'" ':"")+(n.template?'template="'+n.template+'" ':"")+(n.minView?'min-view="'+n.minView+'" ':"")+'class="dropdown-menu"><\/div>'},format:"yyyy-MM-dd HH:mm",views:["date","year","month","hours","minutes"],dismiss:!1,position:"relative"});t.directive("dateTimeAppend",function(){return{link:function(n,t){t.bind("click",function(){t.find("input")[0].focus()})}}});t.directive("dateTime",function(t,i,r,u,f){var e=i.find("body"),o=r("date");return{require:"ngModel",scope:!0,link:function(i,r,c,l){function it(n){return o(n,nt)}function rt(){return l.$modelValue}function ut(n){n.stopPropagation();l.$pristine&&(l.$dirty=!0,l.$pristine=!1,r.removeClass(s).addClass(h),w&&w.$setDirty(),l.$render())}function p(){a&&(a.remove(),a=null);y&&(y.remove(),y=null)}function ft(){if(!a){if(a=t(g)(i),i.$digest(),i.$on("setDate",function(n,t,i){ut(n);tt&&v[v.length-1]===i&&p()}),i.$on("$destroy",p),d==="absolute"){var u=n.extend(r.offset(),{height:r[0].offsetHeight});a.css({top:u.top+u.height,left:u.left,display:"block",position:d});e.append(a)}else y=n.element("<div date-picker-wrapper><\/div>"),r[0].parentElement.insertBefore(y[0],r[0]),y.append(a),a.css({top:r[0].offsetHeight+"px",display:"block"});a.bind("mousedown",function(n){n.preventDefault()})}}var nt=c.format||u.format,w=r.inheritedData("$formController"),v=f(c.views)(i)||u.views.concat(),b=c.view||v[0],k=v.indexOf(b),tt=c.dismiss?f(c.dismiss)(i):u.dismiss,a=null,d=c.position||u.position,y=null,g;k===-1&&v.splice(k,1);v.unshift(b);l.$formatters.push(it);l.$parsers.unshift(rt);g=u.template(c);r.bind("focus",ft);r.bind("blur",p)}}});n.module("datePicker").run(["$templateCache",function(n){n.put("templates/datepicker.html",'<div ng-switch="view">\n  <div ng-switch-when="date">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev()">‹<\/th>\n        <th colspan="5" class="switch" ng-click="setView(\'month\')">{{date|date:"yyyy MMMM"}}<\/th>\n        <th ng-click="next()">›<\/i><\/th>\n      <\/tr>\n      <tr>\n        <th ng-repeat="day in weekdays" style="overflow: hidden">{{ day|date:"EEE" }}<\/th>\n      <\/tr>\n      <\/thead>\n      <tbody>\n      <tr ng-repeat="week in weeks">\n        <td ng-repeat="day in week">\n          <span\n            ng-class="{\'now\':isNow(day),\'active\':isSameDay(day),\'disabled\':(day.getMonth()!=date.getMonth()),\'after\':isAfter(day),\'before\':isBefore(day)}"\n            ng-click="setDate(day)" ng-bind="day.getDate()"><\/span>\n        <\/td>\n      <\/tr>\n      <\/tbody>\n    <\/table>\n  <\/div>\n  <div ng-switch-when="year">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev(10)">‹<\/th>\n        <th colspan="5" class="switch">{{years[0].getFullYear()}}-{{years[years.length-1].getFullYear()}}<\/th>\n        <th ng-click="next(10)">›<\/i><\/th>\n      <\/tr>\n      <\/thead>\n      <tbody>\n      <tr>\n        <td colspan="7">\n                    <span ng-class="{\'active\':isSameYear(year),\'now\':isNow(year)}"\n                          ng-repeat="year in years"\n                          ng-click="setDate(year)" ng-bind="year.getFullYear()"><\/span>\n\n\n        <\/td>\n      <\/tr>\n      <\/tbody>\n    <\/table>\n  <\/div>\n  <div ng-switch-when="month">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev()">‹<\/th>\n        <th colspan="5" class="switch" ng-click="setView(\'year\')">{{ date|date:"yyyy" }}<\/th>\n        <th ng-click="next()">›<\/i><\/th>\n      <\/tr>\n      <\/thead>\n      <tbody>\n      <tr>\n        <td colspan="7">\n                <span ng-repeat="month in months"\n                      ng-class="{\'active\':isSameMonth(month),\'after\':isAfter(month),\'before\':isBefore(month),\'now\':isNow(month)}"\n                      ng-click="setDate(month)">{{month|date:\'MMM\'}}<\/span>\n\n        <\/td>\n      <\/tr>\n      <\/tbody>\n    <\/table>\n  <\/div>\n  <div ng-switch-when="hours">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev(24)">‹<\/th>\n        <th colspan="5" class="switch" ng-click="setView(\'date\')">{{ date|date:"dd MMMM yyyy" }}<\/th>\n        <th ng-click="next(24)">›<\/i><\/th>\n      <\/tr>\n      <\/thead>\n      <tbody>\n      <tr>\n        <td colspan="7">\n                <span ng-repeat="hour in hours"\n                      ng-class="{\'now\':isNow(hour),\'active\':isSameHour(hour)}"\n                      ng-click="setDate(hour)" ng-bind="hour.getHours()+\':00\'"><\/span>\n        <\/td>\n      <\/tr>\n      <\/tbody>\n    <\/table>\n  <\/div>\n  <div ng-switch-when="minutes">\n    <table>\n      <thead>\n      <tr>\n        <th ng-click="prev()">‹<\/th>\n        <th colspan="5" class="switch" ng-click="setView(\'hours\')">{{ date|date:"dd MMMM yyyy" }}\n        <\/th>\n        <th ng-click="next()">›<\/i><\/th>\n      <\/tr>\n      <\/thead>\n      <tbody>\n      <tr>\n        <td colspan="7">\n                    <span ng-repeat="minute in minutes"\n                          ng-class="{active:isSameMinutes(minute),\'now\':isNow(minute)}"\n                          ng-click="setDate(minute)">{{minute|date:"HH:mm"}}<\/span>\n        <\/td>\n      <\/tr>\n      <\/tbody>\n    <\/table>\n  <\/div>\n<\/div>\n');n.put("templates/daterange.html",'<div>\n    <table>\n        <tr>\n            <td valign="top">\n                <div date-picker="start" class="date-picker" date after="start" before="end" min-view="date" max-view="date"><\/div>\n            <\/td>\n            <td valign="top">\n                <div date-picker="end" class="date-picker" date after="start" before="end"  min-view="date" max-view="date"><\/div>\n            <\/td>\n        <\/tr>\n    <\/table>\n<\/div>\n')}])})(angular);